<% @title = "顧客管理" %>
<h1><%= @title %></h1>

<div class="table-wrapper">
  <div class="links">
    <%= link_to "新人登録", new_staff_customer_path %>
  </div>

  <%= paginate @customers if @customers.respond_to?(:current_page) %>

  <table class="listing">
    <tr>
      <th>氏名</th>
      <th>フリガナ</th>
      <th>メールアドレス</th>
      <th>生年月日</th>
      <th>性別</th>
      <th>アクション</th>
    </tr>

    <% @customers.each do |c| %>
      <% p = CustomerPresenter.new(c, self) rescue OpenStruct.new(
           full_name: "#{c.family_name} #{c.given_name}",
           full_name_kana: "#{c.family_name_kana} #{c.given_name_kana}"
         ) %>
      <tr>
        <td><%= p.full_name %></td>
        <td><%= p.full_name_kana %></td>
        <td><%= c.email %></td>
        <td><%= c.birthday %></td>
        <td><%= p.gender %></td>
        <td class="actions">
          <%= link_to "詳細", staff_customer_path(c) %> |
          <%= link_to "編集", edit_staff_customer_path(c) %> |
          <%= link_to "削除", staff_customer_path(c), method: :delete, data: { confirm: "本当に削除しますか？" } %>
        </td>
      </tr>
    <% end %>
  </table>

  <%= paginate @customers if @customers.respond_to?(:current_page) %>
</div>