<%= f.fields_for :customer, f.object.customer do |ff| %>
  <% markup do |m| 
    p = CustomerFormPresenter.new(ff, self)
    p.with_options(required: true) do |q|
      m << q.text_field_block(:email, "メールアドレス", size: 32)
      m << q.password_field_block(:password, "パスワード", size: 32)
      m << q.full_name_block(:family_name, :given_name, "氏名")
      m << q.full_name_block(:family_name_kana, :given_name_kana, "フリガナ")
    end
    m << p.date_field_block(:birthday, "生年月日")
    m << p.gender_field_block
  end %>
<% end %>

<%= f.fields_for :home_address, f.object.customer.home_address || f.object.customer.build_home_address do |ff| %>
  <% markup do |m| 
    p = AddressFormPresenter.new(ff, self)
    p.with_options(required: true) do |q|
      m << q.postal_code_block(:postal_code, "郵便番号", size: 7)
      m << q.drop_down_list_block(:prefecture, "都道府県", Address::PREFECTURE_NAMES)
      m << q.text_field_block(:city, "市区町村", size: 16)
      m << q.text_field_block(:address1, "町域、番地等", size: 40)
    end
    m << p.text_field_block(:address2, "建物名、部屋番号等", size: 40)
  end %>
<% end %>

<%= f.fields_for :work_address, f.object.customer.work_address || f.object.customer.build_work_address do |ff| %>
  <% markup do |m|
    p = AddressFormPresenter.new(ff, self)
    m << p.text_field_block(:company_name, "会社名", size: 40, required: true)
    m << p.text_field_block(:division_name, "部署名", size: 40)
    m << p.postal_code_block(:postal_code, "郵便番号", size: 7)
    m << p.drop_down_list_block(:prefecture, "都道府県", Address::PREFECTURE_NAMES)
    m << p.text_field_block(:city, "市区町村", size: 16)
    m << p.text_field_block(:address1, "町域、番地等", size: 40)
    m << p.text_field_block(:address2, "建物名、部屋番号等", size: 40)
  end %>
<% end %>